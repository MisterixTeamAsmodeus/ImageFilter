# ImageFilter - Приложение для обработки JPEG-изображений

Высокопроизводительное консольное приложение на C++20 для применения фильтров к JPEG-изображениям с самостоятельной реализацией всех алгоритмов обработки изображений.

## Технические характеристики

- **Язык**: C++20
- **Компилятор**: Clang (предпочтительно) или любой компилятор с поддержкой C++20
- **Библиотеки**: STB Image (автоматически загружается через CMake FetchContent)
- **Система сборки**: CMake 3.20+
- **Параллелизм**: Многопоточная обработка с использованием std::thread

## Реализованные фильтры

Проект включает 22 фильтра, разделенных на 5 категорий:

### Цветовые фильтры (6)

1. **grayscale** - Преобразование в оттенки серого
   - Формула: Y = 0.299R + 0.587G + 0.114B
   - Основана на восприятии яркости человеческим глазом

2. **sepia** - Эффект сепии (винтажный)
   - Применяет классический сепия-тон для создания винтажного эффекта

3. **invert** - Инверсия цветов
   - Инвертирует все цветовые каналы: R' = 255 - R, G' = 255 - G, B' = 255 - B

4. **brightness** - Изменение яркости
   - Увеличивает или уменьшает яркость изображения (коэффициент по умолчанию: 1.2)

5. **contrast** - Изменение контрастности
   - Регулирует контрастность изображения (коэффициент по умолчанию: 1.5)

6. **saturation** - Изменение насыщенности
   - Изменяет насыщенность цветов (коэффициент по умолчанию: 1.5)

### Геометрические фильтры (3)

7. **flip_h** - Горизонтальное отражение
   - Отражает изображение по вертикальной оси

8. **flip_v** - Вертикальное отражение
   - Отражает изображение по горизонтальной оси

9. **rotate90** - Поворот на 90 градусов
   - Поворачивает изображение на 90 градусов по часовой стрелке

### Фильтры краёв и деталей (4)

10. **sharpen** - Повышение резкости
    - Использует классическое ядро unsharp masking
    - Усиливает края и детали изображения

11. **edges** - Детекция краёв
    - Использует оператор Собеля для обнаружения границ объектов

12. **emboss** - Эффект рельефа
    - Создает эффект объемного рельефа на изображении

13. **outline** - Выделение контуров
    - Выделяет контуры объектов на изображении

### Фильтры размытия и шума (5)

14. **blur** - Размытие по Гауссу
    - Использует separable kernel для оптимизации производительности
    - Радиус размытия: 5.0 (по умолчанию)
    - Оптимизация: O(2N) вместо O(N²) операций на пиксель

15. **box_blur** - Размытие по прямоугольнику
    - Простое размытие с использованием прямоугольного ядра (радиус: 5)

16. **motion_blur** - Размытие движения
    - Имитирует эффект движения камеры (длина: 10, угол: 0°)

17. **median** - Медианный фильтр
    - Удаляет шум и сглаживает изображение (радиус: 2)

18. **noise** - Добавление шума
    - Добавляет случайный шум к изображению (интенсивность: 0.1)

### Стилистические фильтры (3)

19. **posterize** - Постеризация
    - Уменьшает количество цветовых уровней (4 уровня по умолчанию)

20. **threshold** - Пороговая бинаризация
    - Преобразует изображение в черно-белое по порогу (порог: 128)

21. **vignette** - Виньетирование
    - Создает эффект затемнения по краям изображения (сила: 0.5)

## Сборка проекта

### Требования

- CMake 3.20 или выше
- Компилятор Clang с поддержкой C++20 (рекомендуется)
- Git (для загрузки STB Image через FetchContent)

### Инструкция по сборке

#### Windows (с использованием Clang)

```powershell
# Создаем директорию для сборки
mkdir build
cd build

# Настраиваем проект с указанием Clang
cmake .. -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_BUILD_TYPE=Release

# Собираем проект
cmake --build . --config Release

# Исполняемый файл будет в build/bin/ImageFilter.exe
```

#### Linux/macOS (с использованием Clang)

```bash
# Создаем директорию для сборки
mkdir build
cd build

# Настраиваем проект с указанием Clang
cmake .. -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_BUILD_TYPE=Release

# Собираем проект
cmake --build . --config Release

# Исполняемый файл будет в build/bin/ImageFilter
```

### Альтернативная сборка (если Clang недоступен)

Если Clang не установлен, проект можно собрать с другим компилятором C++20:

```bash
mkdir build
cd build
cmake .. -DCMAKE_BUILD_TYPE=Release
cmake --build . --config Release
```

## Использование

### Синтаксис команды

```bash
./ImageFilter <input.jpg> <filter_name> <output.jpg>
```

### Параметры

- `input.jpg` - путь к входному JPEG-изображению
- `filter_name` - название фильтра (см. список выше)
- `output.jpg` - путь к выходному JPEG-изображению

### Примеры использования

#### Преобразование в оттенки серого

```bash
./ImageFilter input.jpg grayscale output_gray.jpg
```

#### Применение размытия по Гауссу

```bash
./ImageFilter input.jpg blur output_blurred.jpg
```

#### Повышение резкости

```bash
./ImageFilter input.jpg sharpen output_sharpened.jpg
```

#### Применение эффекта сепии

```bash
./ImageFilter input.jpg sepia output_sepia.jpg
```

#### Детекция краёв

```bash
./ImageFilter input.jpg edges output_edges.jpg
```

#### Поворот изображения

```bash
./ImageFilter input.jpg rotate90 output_rotated.jpg
```

### Получение списка доступных фильтров

Если запустить программу без параметров или с неправильным количеством аргументов, будет выведен полный список доступных фильтров с их описанием.

## Особенности реализации


### Оптимизации производительности

1. **Separable Kernel для Gaussian Blur**
   - Вместо применения двумерного ядра N×N (O(N²) операций)
   - Применяется одномерное ядро дважды: горизонтально и вертикально (O(2N) операций)
   - Значительное ускорение для больших радиусов размытия

2. **Многопоточная обработка**
   - Автоматическое определение количества доступных ядер процессора
   - Разделение изображения на горизонтальные полосы для параллельной обработки
   - Использование std::thread для распараллеливания вычислений
   - Оптимизирует производительность для больших изображений

3. **Оптимизация компилятора**
   - Использование флагов оптимизации -O3 для Release сборки
   - Включение предупреждений компилятора для повышения качества кода

### Структура проекта

```
ImageFilter/
├── include/              # Заголовочные файлы
│   ├── filters/         # Интерфейсы и заголовки фильтров
│   ├── utils/           # Утилиты (параллельная обработка)
│   └── ImageProcessor.h # Основной класс для работы с изображениями
├── src/                 # Исходные файлы
│   ├── filters/         # Реализации фильтров
│   ├── utils/           # Реализации утилит
│   ├── ImageProcessor.cpp
│   └── main.cpp         # Точка входа приложения
├── benchmark/           # Инструменты для бенчмарка (см. benchmark/README.md)
└── CMakeLists.txt       # Конфигурация сборки
```

## Зависимости

- **STB Image** (stb_image.h, stb_image_write.h)
  - Автоматически загружается через CMake FetchContent
  - Используется только для чтения и записи JPEG-файлов
  - Все алгоритмы обработки реализованы самостоятельно

## Бенчмарк

Проект включает инструменты для измерения производительности фильтров. Подробная информация доступна в [benchmark/README.md](benchmark/README.md).

## Лицензия

Учебный проект для изучения обработки изображений на C++20.

